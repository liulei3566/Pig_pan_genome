pdf("Boxplot.pdf",width=10,height=10)
library(ggplot2)
library(ggsignif)
data <- read.table("boxplot.matrix",header=T)
attach(data)
data$Sample<-as.character(data$Sample)
len <- length(unique(data$Sample))
colours<-c("#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500","#53B3E9", "#E39500")
ggplot(data, aes(x=Sample, y=log10FPKM)) + geom_boxplot(aes(fill=factor(Sample))) +
	theme_bw()+
	theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()) + 
	scale_fill_manual(values=colours,name="Sample") +theme(axis.text.x = element_text(colour="grey20",size=11,angle=30, hjust =1)) +
	labs(x='Sample',y='log10FPKM') +
	guides(fill = guide_legend(title = "Sample",keywidth = 2, keyheight = 2))+
	theme(axis.title.y = element_text(size = 18))+
	theme(axis.text.y = element_text(size=16,hjust =1))+
	#theme(axis.text.x = element_text(face="bold",size=96/len,angle=30, hjust =1),panel.grid.major=element_line(colour=NA),panel.grid =element_blank())+
	theme(axis.text.x = element_text(size=12,angle=30, hjust =1))+
	theme(legend.title=element_text(size=15))+
	theme(legend.text=element_text(size=15))+
	geom_signif(comparisons=list(c("adipose-negative","adipose-positive"),c("cerebellum-negative","cerebellum-positive"),c("cerebrum-negative","cerebrum-positive"),c("heart-negative","heart-positive"),c("liver-negative","liver-positive"),c("lung-negative","lung-positive"),c("muscle-negative","muscle-positive"),c("pancreas-negative","pancreas-positive"),c("small_intestine-negative","small_intestine-positive"),c("stomach-negative","stomach-positive")),step_increase = 0.1,test="wilcox.test",map_signif_level=T)+
        scale_y_continuous(expand = c(0,0),limits = c(1,10),breaks = c(1,2,3,4,5,6,7,8,9,10),label = c(1,2,3,4,5,6,7,8,9,10)) 
dev.off()
